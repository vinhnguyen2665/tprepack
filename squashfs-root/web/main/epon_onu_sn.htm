<script language="javascript" type="text/javascript">

var onuSnStack = {};
var onuSnList = {};
var curSn;

var chipsetStack = {};
var chipsetList = {};
var curChipset;

var capabilityStack = {};
var capabilityList = {};
var curCapability;

function init()
{
	var ponCfgObj = {};
	var snId;
	
	ponCfgObj = $.act(ACT_GET, PON_CFG, null, null);
	if (!$.exe())
	{
		snId = ponCfgObj.onuSnId;
	}

	onuSnList = $.act(ACT_GL, EPON_ONU_SN, null, null, null);
	if (!$.exe())
	{
		onuSnStack = onuSnList[snId].__stack;
	}
	
	curSn = $.act(ACT_GET, EPON_ONU_SN, onuSnStack, null);
	if (!$.exe())
	{
		$.id("vendor_id").value = curSn.vendorId;
		$.id("onu_model").value = curSn.onuModel;
		$.id("mac").value = curSn.onuId;
		$.id("hd_ver").value = curSn.hardwareVersion;
		$.id("soft_ver").value = curSn.softwareVersion;
	}
	
	chipsetList = $.act(ACT_GL, EPON_CHIPSETID, null, null, null);
	if (!$.exe())
	{
		chipsetStack = chipsetList[snId].__stack;
	}
	
	curChipset = $.act(ACT_GET, EPON_CHIPSETID, chipsetStack, null);
	if (!$.exe())
	{
		$.id("chipset_id").value = parseInt(curChipset.vendorId).toString(16);
		$.id("chipset_model").value = parseInt(curChipset.chipModel).toString(16);
		$.id("chipset_revision").value = parseInt(curChipset.revision).toString(16);
		$.id("chipset_date").value = parseInt(curChipset.ICVersionDate).toString(16);
	}
	
	capabilityList = $.act(ACT_GL, EPON_CAPABILITIES, null, null, null);
	if (!$.exe())
	{
		capabilityStack = capabilityList[snId].__stack;
	}
	
	curCapability = $.act(ACT_GET, EPON_CAPABILITIES, capabilityStack, null);
	if (!$.exe())
	{
		$.id("capability_ge").value = parseInt(curCapability.geNum);
		$.id("capability_fe").value = parseInt(curCapability.feNum);
	}
}

function doClick(obj)
{
	curSn.vendorId = $.id("vendor_id").value;
	curSn.onuModel = $.id("onu_model").value;
	curSn.onuId = $.id("mac").value;
	curSn.hardwareVersion = $.id("hd_ver").value;
	curSn.softwareVersion = $.id("soft_ver").value;
		
	if($.mac(curSn.onuId,false))
	{
		var element = $.id("mac");
		if(element)
		{
			element.focus();
			element.select();
		}
		return false;
	}
	
	if($.ishexstr($.id("chipset_id").value) == false)
	{
		var element = $.id("chipset_id");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input hexadecimal number[0 - 9, a - f, A - F]");
		return false;
	}
	
	if($.ishexstr($.id("chipset_model").value) == false)
	{
		var element = $.id("chipset_model");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input hexadecimal number[0 - 9, a - f, A - F]");
		return false;
	}
	
	if($.ishexstr($.id("chipset_revision").value) == false)
	{
		var element = $.id("chipset_revision");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input hexadecimal number[0 - 9, a - f, A - F]");
		return false;
	}
	
	if($.ishexstr($.id("chipset_date").value) == false)
	{
		var element = $.id("chipset_date");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input hexadecimal number[0 - 9, a - f, A - F]");
		return false;
	}
	
	if($.isnum($.id("capability_ge").value) == false)
	{
		var element = $.id("capability_ge");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input decimal number[0 - 9]");
		return false;
	}
	
	if($.isnum($.id("capability_fe").value) == false)
	{
		var element = $.id("capability_fe");
		if(element)
		{
			element.focus();
			element.select();
		}
		alert("Please input decimal number[0 - 9]");
		return false;
	}
	
	curChipset.vendorId = parseInt($.id("chipset_id").value, 16);
	curChipset.chipModel = parseInt($.id("chipset_model").value, 16);
	curChipset.revision = parseInt($.id("chipset_revision").value, 16);
	curChipset.ICVersionDate = parseInt($.id("chipset_date").value, 16);
	
	curCapability.geNum = parseInt($.id("capability_ge").value, 10);
	curCapability.feNum = parseInt($.id("capability_fe").value, 10);
	
	$.act(ACT_SET, EPON_ONU_SN, onuSnStack, null, curSn);
	$.act(ACT_SET, EPON_CHIPSETID, chipsetStack, null, curChipset);
	$.act(ACT_SET, EPON_CAPABILITIES, capabilityStack, null, curCapability);
	
	if (!$.exe())
	{
		curSn = $.act(ACT_GET, EPON_ONU_SN, onuSnStack, null);
		if (!$.exe())
		{
			$.id("vendor_id").value = curSn.vendorId;
			$.id("onu_model").value = curSn.onuModel;
			$.id("mac").value = curSn.onuId;
			$.id("hd_ver").value = curSn.hardwareVersion;
			$.id("soft_ver").value = curSn.softwareVersion;
		}
		
		curChipset = $.act(ACT_GET, EPON_CHIPSETID, chipsetStack, null);
		if (!$.exe())
		{
			$.id("chipset_id").value = parseInt(curChipset.vendorId).toString(16);
			$.id("chipset_model").value = parseInt(curChipset.chipModel).toString(16);
			$.id("chipset_revision").value = parseInt(curChipset.revision).toString(16);
			$.id("chipset_date").value = parseInt(curChipset.ICVersionDate).toString(16);
		}
		
		curCapability = $.act(ACT_GET, EPON_CAPABILITIES, capabilityStack, null);
		if (!$.exe())
		{
			$.id("capability_ge").value = parseInt(curCapability.geNum);
			$.id("capability_fe").value = parseInt(curCapability.feNum);
		}
		
		$.act(ACT_OP, ACT_OP_OAM_RESTART);
		$.exe();
	}
}

</script>

<div class="con1 M">
<p class="ct" id="manage_title_">Device information setting</p>
<p class="bl"></p>
<div class="con2">
<p class="br" />
<p class="itemR bd" id="device_info_"><span style="font-size:16px; font-weight:bold">Device information</span></p>
<p><b class="item M" id="vendor_id_">Vendor ID: </b><input type="text" class="text" size="17" maxlength="4" id="vendor_id" /></p>
<p><b class="item M" id="onu_model_">Model: </b><input type="text" class="text" size="17" maxlength="4" id="onu_model" /></p>
<p><b class="item M" id="mac_">MAC address: </b><input type="text" class="text" size="17" maxlength="17" id="mac" /></p>
<p><b class="item M" id="hd_ver_">Hardware version: </b><input type="text" class="text" size="17" maxlength="8" id="hd_ver" /></p>
<p><b class="item M" id="soft_ver_">Software version: </b><input type="text" class="text" size="17" maxlength="16" id="soft_ver" /></p>
<p class="br"></p>
<p class="itemR bd" id="chipset_info_"><span style="font-size:16px; font-weight:bold">Chipset information (Please use hexadecimal number to modify)</span></p>
<p><b class="item M" id="chipset_id_">Chipset ID: </b><input type="text" class="text" size="17" maxlength="4" id="chipset_id" /></p>
<p><b class="item M" id="chipset_model_">Chipset model: </b><input type="text" class="text" size="17" maxlength="4" id="chipset_model" /></p>
<p><b class="item M" id="chipset_revision_">Chipset revision: </b><input type="text" class="text" size="17" maxlength="2" id="chipset_revision" /></p>
<p><b class="item M" id="chipset_date_">Chipset date: </b><input type="text" class="text" size="17" maxlength="6" id="chipset_date" /></p>
<p class="br"></p>
<p class="itemR bd" id="capability_info_"><span style="font-size:16px; font-weight:bold">ONU capability</span></p>
<p><b class="item M" id="capability_ge_">GE Port number: </b><input type="text" class="text" size="17" maxlength="1" id="capability_ge" /></p>
<p><b class="item M" id="capability_ge_">FE Port number: </b><input type="text" class="text" size="17" maxlength="1" id="capability_fe" /></p>
</div>

<p class="tail" id="tail">
<input type="button" class="button L " value="Save" id="save" onclick="doClick(this);" /></p>
</div>

<script language="javascript" type="text/javascript">
init();
</script>
	
	
	